<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      http-equiv="Content-Security-Policy"
      content="default-src 'self'; style-src 'self' 'unsafe-inline';"
    />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Sync App</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <div class="app">
      <header>
        <div class="title-block">
          <img
            class="logo"
            src="public/icons/sync-app.png"
            alt="Sync App logo"
          />
          <div>
            <h1>
              Sync App <span id="appVersion" class="version">v1.0.0</span>
              <span id="lastRunBadge" class="status-badge hidden">Last: —</span>
            </h1>
            <p>Fast and reliable backups.</p>
          </div>
        </div>
        <div class="header-actions no-drag">
          <button
            id="openReleaseNotes"
            class="ghost small has-tooltip"
            data-tooltip="Read what’s new in each release"
          >
            Release Notes
          </button>
          <button
            id="openHistory"
            class="ghost small has-tooltip"
            data-tooltip="View previous sync runs"
          >
            History
          </button>
          <button id="openHelp" class="ghost small has-tooltip" data-tooltip="App guide">
            Help
          </button>
          <button id="openTerms" class="ghost small has-tooltip" data-tooltip="Terms of use">
            Terms
          </button>
          <button
            id="checkUpdates"
            class="ghost small has-tooltip"
            data-tooltip="Check GitHub Releases for updates"
          >
            Update
          </button>
          <label
            class="toggle compact has-tooltip"
            data-tooltip="Check GitHub Releases automatically on launch"
          >
            <input id="autoUpdateToggle" type="checkbox" />
            <span class="toggle-pill"></span>
            <span>Auto‑Update</span>
          </label>
        </div>
      </header>

      <section class="card">
        <div class="subsection">
          <div class="section-header">
            <h2>Folders</h2>
            <p>Select source and destination.</p>
          </div>
          <div class="field">
            <label for="sourcePath">Source folder</label>
            <div class="field-row">
              <input id="sourcePath" type="text" readonly placeholder="Choose source…" />
              <button id="chooseSource">Select</button>
            </div>
          </div>
          <div class="field">
            <label for="destinationPath">Destination folder</label>
            <div class="field-row">
              <input
                id="destinationPath"
                type="text"
                readonly
                placeholder="Choose destination…"
              />
              <button id="chooseDestination">Select</button>
            </div>
          </div>
        </div>

        <div class="subsection">
          <div class="section-header">
            <h2>Exclusions</h2>
            <p>Keep backups lean and focused.</p>
          </div>
          <div class="field">
            <label for="customExclude">Exclude patterns</label>
            <div id="excludeGrid" class="exclude-grid"></div>
            <div class="exclude-input-row">
              <input
                id="customExclude"
                type="text"
                placeholder="Add a pattern (e.g. *.tmp)"
              />
              <button id="addExclude" class="ghost small" type="button">Add</button>
            </div>
            <p class="helper">
              Click a pattern to enable/disable it. Add custom patterns as needed.
            </p>
          </div>
        </div>

        <div class="subsection-grid">
          <div class="subsection">
            <div class="section-header">
              <h2>Profiles</h2>
              <p>Save presets for quick reuse.</p>
            </div>
            <div class="field">
              <label for="profileSelect">Profiles</label>
              <div class="profile-row">
                <select id="profileSelect"></select>
                <button id="applyProfile" class="ghost small" type="button">Apply</button>
                <button id="deleteProfile" class="ghost small" type="button">Delete</button>
              </div>
              <div class="profile-save-row">
                <input id="profileName" type="text" placeholder="Profile name" />
                <button id="saveProfile" class="ghost small" type="button">
                  Save Profile
                </button>
              </div>
              <p id="profileStatus" class="helper">No profiles yet.</p>
            </div>
          </div>

          <div class="subsection">
            <div class="section-header">
              <h2>Schedule</h2>
              <p>Run profiles automatically.</p>
            </div>
            <div class="field">
              <label for="scheduleCadence">Schedule</label>
              <div class="schedule-row">
                <label class="toggle compact">
                  <input id="scheduleEnabled" type="checkbox" />
                  <span class="toggle-pill"></span>
                  <span>Enabled</span>
                </label>
                <select id="scheduleCadence">
                  <option value="daily">Daily</option>
                  <option value="weekly">Weekly</option>
                </select>
                <select id="scheduleDay">
                  <option value="1">Monday</option>
                  <option value="2">Tuesday</option>
                  <option value="3">Wednesday</option>
                  <option value="4">Thursday</option>
                  <option value="5">Friday</option>
                  <option value="6">Saturday</option>
                  <option value="0">Sunday</option>
                </select>
                <input id="scheduleTime" type="time" value="09:00" />
                <select id="scheduleProfile"></select>
                <button id="saveSchedule" class="ghost small" type="button">Save</button>
                <button id="runSchedule" class="ghost small" type="button">Run now</button>
              </div>
              <p id="scheduleNextRun" class="helper">Not scheduled.</p>
            </div>
          </div>
        </div>

        <div class="subsection">
          <div class="section-header">
            <h2>Sync Options</h2>
            <p>Control how your backup runs.</p>
          </div>
          <div class="field">
            <label
              class="toggle has-tooltip"
              data-tooltip="Copy the source folder itself into the destination"
            >
              <input id="preserveRootToggle" type="checkbox" />
              <span class="toggle-pill"></span>
              <span>Preserve root folder in destination</span>
            </label>
            <p class="helper">
              When enabled, copies the source folder itself (not just its contents).
            </p>
          </div>
          <div class="actions">
            <button id="startSync" class="primary">Start Sync</button>
            <button id="previewSync" class="ghost">Preview</button>
            <button id="cancelSync" class="ghost" disabled>Cancel</button>
            <button id="openLogFolder" class="ghost">Open Log Folder</button>
            <button id="openSource" class="ghost">Open Source</button>
            <button id="openDestination" class="ghost">Open Destination</button>
          </div>
          <p id="statusMessage" class="status">Ready.</p>
          <button id="updateLink" class="status-link hidden">Download latest</button>
        </div>
      </section>

      <section class="card">
        <div class="progress-header">
          <h2>Progress</h2>
          <span id="progressPercent">0%</span>
        </div>
        <div class="progress-bar">
          <div id="progressFill"></div>
        </div>
        <div class="stream" id="streamLog" aria-live="polite"></div>
      </section>

    </div>

    <div id="releaseNotesModal" class="modal hidden" role="dialog" aria-modal="true">
      <div class="modal-content card">
        <div class="modal-header">
          <h2 id="releaseNotesTitle">Release Notes</h2>
          <button id="closeReleaseNotes" class="ghost small">Close</button>
        </div>
        <div id="releaseNotesBody" class="modal-body"></div>
      </div>
    </div>

    <div id="helpModal" class="modal hidden" role="dialog" aria-modal="true">
      <div class="modal-content card">
        <div class="modal-header">
          <h2>Help</h2>
          <button id="closeHelp" class="ghost small">Close</button>
        </div>
        <div class="modal-body" id="helpBody">
          <h3>Folders</h3>
          <ul>
            <li><strong>Source folder:</strong> What you want to back up.</li>
            <li><strong>Destination folder:</strong> Where the backup goes.</li>
            <li><strong>Open Destination:</strong> Opens the destination in Finder.</li>
          </ul>

          <h3>Sync Options</h3>
          <ul>
            <li><strong>Exclude patterns:</strong> Toggle common patterns or add custom ones (e.g., <code>.git</code>, <code>node_modules</code>, <code>*.tmp</code>).</li>
            <li><strong>Preserve root folder:</strong> Copies the source folder itself into destination.</li>
            <li><strong>Preview:</strong> Dry‑run to show what would change without copying.</li>
          </ul>

          <h3>Actions</h3>
          <ul>
            <li><strong>Start Sync:</strong> Begins the copy.</li>
            <li><strong>Cancel:</strong> Stops an active sync.</li>
            <li><strong>Open Log Folder:</strong> Opens log files for each run.</li>
          </ul>

          <h3>Updates</h3>
          <ul>
            <li><strong>Update:</strong> Checks for updates (or installs if ready).</li>
            <li><strong>Auto‑Update:</strong> Checks automatically on launch.</li>
          </ul>
        </div>
      </div>
    </div>

    <div id="historyModal" class="modal hidden" role="dialog" aria-modal="true">
      <div class="modal-content card">
        <div class="modal-header">
          <div>
            <h2>History</h2>
            <p class="helper" id="historyCount">0 runs</p>
          </div>
          <button id="closeHistory" class="ghost small">Close</button>
        </div>
        <div class="modal-body">
          <div id="lastSummary" class="history-summary"></div>
          <div id="historyList" class="history-list"></div>
        </div>
      </div>
    </div>

    <div id="termsModal" class="modal hidden" role="dialog" aria-modal="true">
      <div class="modal-content card">
        <div class="modal-header">
          <h2>Terms of Use</h2>
          <button id="closeTerms" class="ghost small">Close</button>
        </div>
        <div class="modal-body" id="termsBody"></div>
      </div>
    </div>

    <script src="renderer.js"></script>
  </body>
</html>
